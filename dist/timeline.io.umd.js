(()=>{var fe=Object.defineProperty,pe=Object.defineProperties;var ye=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var Te=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var U=(T,g,l)=>g in T?fe(T,g,{enumerable:!0,configurable:!0,writable:!0,value:l}):T[g]=l,j=(T,g)=>{for(var l in g||(g={}))Te.call(g,l)&&U(T,l,g[l]);if(Q)for(var l of Q(g))ve.call(g,l)&&U(T,l,g[l]);return T},P=(T,g)=>pe(T,ye(g));var ee=(T,g)=>{let l,I,D,A,u,h,y,w,M,S,q=[],Y,N,te=e=>{if(!e)throw new Error("Event argument is empty. Please provide Timeline event as first arg");J(N,e),x()},ne=(e,n)=>{if(!e)throw new Error("Element argument is empty. DOM element | selector as first arg");if(typeof e=="string"){let s=document.querySelector(e);if(!s)throw new Error(`Selector could not be found [${u}]`);u=s}e instanceof HTMLElement&&(u=e),h=j({labelCount:5,zoomSpeed:.025,dragSpeed:.001,timelineStart:"-270000",timelineEnd:"1000y",start:"-1000y",end:"100y",minZoom:1,maxZoom:1e11,position:"bottom",expandRatio:80,eventHeight:5},n),N=K({title:"View",type:"container",start:h.start,end:h.end}),D=X(h.timelineStart),A=X(h.timelineEnd);let r=N.start,t=N.end;r<D&&(D=r),t>A&&(A=t);let i=t-r;l=R()/i,I=(D-r)/i,Y=N,de(),ce(u),x()},re=()=>{if(q.length){let[e]=q.slice(-1);return e}},R=()=>A-D,ie=()=>u.offsetWidth||0,L=()=>D-v()*I,z=()=>L()+v(),v=()=>R()/l,oe=()=>h.zoomSpeed*l,E=e=>(e-L())/v(),$=e=>(e-D)/R(),se=(e,n)=>{let r=l-n;return e===1&&r<=h.minZoom||e===-1&&r>=h.maxZoom?!1:(l=r,!0)},O=e=>{let n=I+e;n>=0&&(n=0),n+l<=1&&(n=1-l),I=n},B=(e,n)=>{let r=e*oe(),t=n*r;se(e,r)&&O(t),x()},ae=e=>{O(e),x()},le=e=>{if(!e)return;let n=0,r=e.start-e.duration*.05,i=e.end+e.duration*.05-r,s=R()/i,b=Math.sign(l-s);if(b>0){let f=(L()+v()/2-r)/i,p=L()+v()*f;n=$(p)}else{let d=r+i/2,f=E(d),p=r+i*f;n=$(p)}e!=re()&&q.push(e);let o=()=>{clearInterval(m),x()},c=()=>{x()},m=setInterval(()=>{B(b,n),b<0&&l>s&&o(),b>0&&l<s&&o()},1)},ce=e=>{window.addEventListener("resize",()=>{x()},{passive:!0}),e.addEventListener("wheel",a=>{if(a.defaultPrevented)return;var o=Math.sign(a.deltaY);let f=(((a.target.attributes.starttime?E(a.target.attributes.starttime):0)*e.getBoundingClientRect().width+a.offsetX)/ie()-I)/l;B(o,f)},{passive:!0});let n,r,t=!1,i=!0;e.addEventListener("mousedown",a=>{t=!0,n=a.pageX,r=a.pageY},{passive:!0}),e.addEventListener("mousemove",a=>{if(!t||!i)return;i=!1;let o=(a.pageX-n)*h.dragSpeed;o&&ae(o),n=a.pageX,r=a.pageY,setTimeout(()=>i=!0,10)},{passive:!0}),e.addEventListener("mouseup",()=>{t=!1},{passive:!0});let s=(a,o)=>{let c=document.createDocumentFragment(),m=document.createElement("div");m.className="detailsScrollableContainer",m.style.overflow="auto",m.style.height="100%",m.style.position="absolute";let d=document.createElement("div");if(d.style.padding="10px",m.appendChild(d),c.appendChild(m),console.log(a),a.wikipedia){fetch(a.wikipedia).then(p=>p.json()).then(p=>{let k=document.createElement("H1");if(k.innerHTML=p.query.pages[0].title,d.appendChild(k),p.query.pages[0].thumbnail){let Z=document.createElement("p"),F=document.createElement("img");F.src=p.query.pages[0].thumbnail.source,F.style.width="100%",Z.appendChild(F),d.appendChild(Z)}else p.query.pages[0].images&&p.query.pages[0].images.length;let V=document.createElement("p");V.innerHTML=p.query.pages[0].extract,d.appendChild(V),o(c)});return}let f=document.createElement("H3");f.innerHTML="No detail information found...",c.appendChild(f),o(c)},b=a=>{let o=document.createDocumentFragment(),c=document.createElement("div");c.style.overflow="auto",[...q].reverse().forEach(m=>{let d=document.createElement("a");d.innerHTML=m.title,d.href="#",d.style.cursor="pointer",d.addEventListener("click",f=>{f.preventDefault(),d.dispatchEvent(new CustomEvent("event-click",{detail:m,bubbles:!0,cancelable:!0}))}),c.appendChild(d),c.appendChild(document.createElement("br"))}),o.appendChild(c),a(o)}},G=e=>{if(!e||e.start>=z()||e.end<=L())return;let n=document.createDocumentFragment(),r=()=>{n.append(...e.children.reduce((s,b)=>{let a=G(b);return a&&s.push(a),s},new Array))},t=()=>{let s=e.level*1.5,b=E(e.start),a=e.duration/v()*100,o=document.createElement("div"),c=e.color.map(m=>m-Math.pow(10,1));o.style.bottom=`${s*h.eventHeight}px`,o.style.minHeight=`${h.eventHeight}px`,o.style.borderRadius="5px",o.style.boxSizing="border-box",o.style.cursor="pointer",o.style.border=`1px solid rgba(${c.join(",")})`,o.style.backgroundColor=`rgb(${e.color.join(",")})`,o.style.zIndex=e.depth.toString(),o.addEventListener("click",m=>{o.dispatchEvent(new CustomEvent("event-click",{detail:e,bubbles:!0,cancelable:!0}))}),o.style.left=b*100+"%",o.style.width=a+"%",o.style.position="absolute",o.style.minWidth="5px",o.title=e.title,o.className="timelineEventGenerated",o.attributes.starttime=e.start,o.attributes.expanded=a>h.expandRatio,n.appendChild(o)},i=s=>{let b=s?0:E(e.start),a=s?100:e.duration/v()*100,o=document.createElement("div");o.style.left=b*100+"%",o.style.width=a+"%",o.style.position="absolute",o.style.minWidth="5px",o.style.overflow="hidden",o.style.bottom="0px",o.style.minHeight="100%",o.style.backgroundColor=`rgb(${e.color.join(",")})`,o.title=e.title,o.className="timelineEventGenerated",s||(o.attributes.starttime=e.start),n.appendChild(o);let c=document.createElement("div");c.title=e.title,c.innerText=e.title,c.className="timelineEventGeneratedTitle",c.style.whiteSpace="nowrap",c.style.pointerEvents="none",c.style.userSelect="none",o.appendChild(c)};switch(e.type){case"container":r();break;case"timeline":{e.start<L()&&e.end>z()&&e.children.length?r():t();break}case"background":{e.start<L()&&e.end>z()?i(!0):i(!1);break}}return n},de=()=>{u.style.position="relative",u.style.overflow="hidden",u.style.minHeight="3rem";let e=u.querySelector(".timelineHeaderContainer");S=e||document.createElement("div"),e||u.appendChild(S),S.className="timelineHeaderContainer",S.style.width="100%",S.style.height="20px",S.style.backgroundColor="white";let n=u.querySelector(".timelineLabelContainer");switch(y=n||document.createElement("div"),n||u.appendChild(y),y.className="timelineLabelContainer",y.style.width="100%",y.style.height="50px",y.style.textAlign="center",y.style.position="absolute",y.style.pointerEvents="none",y.style.userSelect="none",h.position){case"top":y.style.top="20px";break;default:y.style.bottom="0"}let r=u.querySelector(".timelineDividerContainer");w=r||document.createElement("div"),r||u.appendChild(w),w.className="timelineDividerContainer",w.style.width="100%",w.style.height="calc(100% - 20px)",w.style.position="absolute",w.style.zIndex="-2",w.style.bottom="0";let t=u.querySelector(".timelineEventsContainer");M=t||document.createElement("div"),t||u.appendChild(M),M.className="timelineEventsContainer",M.style.position="absolute",M.style.bottom="50px",M.style.height="calc(100% - 70px)",M.style.width="100%"},ue=e=>{let n=new Date(e*6e4);return v()<5760?Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}).format(n):v()<60480?Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"numeric"}).format(n):v()<788923.1502?Intl.DateTimeFormat(void 0,{year:"numeric",month:"short"}).format(n):n.getFullYear().toString()},x=()=>{if(!u)return;let e=Math.floor(l),n=Math.pow(2,Math.floor(Math.log2(e))),r=1/(h.labelCount+1),t=L()-D,s=R()*r/n,a=Math.floor(t/s)*s,o=document.createDocumentFragment(),c=document.createDocumentFragment();for(let d=0;d<h.labelCount+2;d++){let f=(d+1)*s+D+a-s,p=f+s/2,V=E(f)*100,F=E(p)*100,C=document.createElement("div");C.className="timelineLabel",C.style.left=V+"%",C.style.top="50%",C.style.transform="translate(calc(-50%), calc(-50%))",C.style.textAlign="center",C.style.position="absolute",C.style.zIndex="-1",C.style.width=r*100+"%",C.innerHTML=ue(f),o.appendChild(C);let H=document.createElement("div");H.className="timelineDivider",H.style.left=F+"%",H.style.textAlign="center",H.style.position="absolute",H.style.height="100%",H.style.zIndex="-10",H.innerHTML="",c.appendChild(H)}y.innerHTML="",y.appendChild(o),w.innerHTML="",w.appendChild(c);let m=G(Y);M.innerHTML="",m&&M.appendChild(m),u.dispatchEvent(new CustomEvent("update",{detail:ge(),bubbles:!0,cancelable:!0,composed:!1}))},X=e=>{if(e===void 0)return;let n=t=>{let i=new Date;if(i.setDate(t[2]?t[2]:1),i.setMonth(t[1]?t[1]-1:0),i.setHours(t[3]?t[3]:0),i.setMinutes(t[4]?t[4]:0),i.setSeconds(0),!t[0])return i.getTime()/6e4;if(t[0]&&t[0]>-27e4&&t[0]<27e4)return i.setFullYear(t[0]),i.getTime()/6e4;let s=525948.766*t[0];return i.setFullYear(0),s+i.getTime()/6e4},r=t=>{switch(t){case"now":return new Date;default:let i=Number(t.replace(/y$/,""));return isNaN(i)?new Date(t):new Date(Date.now()+31556926*1e3*i)}};if(Array.isArray(e)){let t=e;if(t.length===0)throw new Error("argument Array cannot be empty");if(!t.every(s=>typeof s=="number"))throw new Error("input Array must contain only numbers");return n(t)}if(typeof e=="object"&&e.constructor.name==="Date")return e.getTime()/6e4;if(typeof e=="string")return r(e).getTime()/6e4;if(typeof e=="number")return new Date(e).getTime()/6e4},me=e=>e.every(n=>typeof n=="number"),W=e=>e.start?e.children.length?Math.min(e.start,e.children[0].start):e.start:e.children.length?e.children[0].start:void 0,_=e=>e.end?e.end:e.duration&&!isNaN(Number(e.duration))?e.start+Number(e.duration):e.children.length&&e.children[e.children.length-1].end||e.start+1,we=(e,n)=>{let r=0;for(let t in n)if(r=Number(t),e.start>n[t].time)return n[t]={height:e.height,time:e.end},Number(t);return n[(++r).toString()]={height:e.height,time:e.end},r},he=(e,n)=>{let r=0;for(let t in n.levelMatrix)if(r=Number(t),e.start>n.levelMatrix[t].time){for(let i=0;i<e.height;i++)n.levelMatrix[(r+i).toString()]={height:e.height,time:e.end};return r}r++;for(let t=0;t<e.height;t++)n.levelMatrix[(r+t).toString()]={height:e.height,time:e.end};return r},J=(e,...n)=>{let r=(i,s)=>{let b=1;return b=(i.duration||1)/s.duration*s.children.length,b},t=n.map(i=>K(i,e)).filter(i=>!!i);t&&t.length&&e&&(e.children.push(...t),e.children.sort((i,s)=>i.start-s.start),e.start=W(e),e.end=_(e),e.duration=e.end-e.start,e.levelMatrix={1:{height:0,time:Number.MIN_SAFE_INTEGER}},e.children.forEach((i,s)=>{i.level=["container","timeline"].includes(i.type)?he(i,e):0})),e.height=e.children.length?Math.max.apply(1,e.children.map(i=>i.level)):1},K=(e,n)=>{if(!e){console.warn("Event object is empty");return}let r=P(j({type:"timeline",duration:0,level:0,step:0,score:0,height:1,children:[],depth:n?n.depth+1:0},e),{color:e.color?me(e.color)?e.color:[140,140,140,e.type==="background"?.1:1]:[140,140,140,e.type==="background"?.1:1],start:X(e.start),end:X(e.end)});if(e.events&&e.events.length&&J(r,...e.events),r.start=W(r),!r.start){console.warn("Missing start property on event - skipping",e);return}return r.end=_(r),r.duration=r.end-r.start,r},be=e=>{let n=[],r=e.querySelectorAll(".timelineEvent");return r&&r.forEach(t=>{try{n.push(P(j({},t.attributes),{events:be(t)}))}catch(i){console.error(i,"timelineEvent")}}),n},ge=()=>({options:h,viewStartDate:L(),viewEndDate:z(),viewDuration:v(),ratio:l,pivot:I});return ne(T,g),{focus:le,load:te,current:Y,element:u}};window.Timeline=ee;})();
