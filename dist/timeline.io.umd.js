(()=>{var me=Object.defineProperty,ue=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable;var W=(L,v,w)=>v in L?me(L,v,{enumerable:!0,configurable:!0,writable:!0,value:w}):L[v]=w,Y=(L,v)=>{for(var w in v||(v={}))he.call(v,w)&&W(L,w,v[w]);if(_)for(var w of _(v))be.call(v,w)&&W(L,w,v[w]);return L},q=(L,v)=>ue(L,pe(v));var J=(L,v,w)=>{let T,k,x,B,g,h,C,M,E,N,V=[],y,K=(e,a,m)=>{if(!e)throw new Error("Element argument is empty. DOM element | selector as first arg");if(typeof e=="string"){let o=document.querySelector(e);if(!o)throw new Error(`Selector could not be found [${g}]`);g=o}e instanceof HTMLElement&&(g=e),h=Y({labelCount:5,zoomSpeed:.025,dragSpeed:.001,timelineStart:"-1000y",timelineEnd:"100y",minZoom:1,maxZoom:1e11,position:"bottom",expandRatio:80,eventHeight:5},m),y=G(a),V.push(y),x=z(h.timelineStart),B=z(h.timelineEnd);let n=h.viewStart?z(h.viewStart):y.start-y.duration*.05,t=h.viewEnd?z(h.viewEnd):y.end+y.duration*.05;n<x&&(x=n),t>B&&(B=t);let d=t-n;T=F()/d,k=(x-n)/d,oe(),re(g),A()},R=()=>{let[e]=V.slice(-1);return e},F=()=>B-x,Q=()=>g.offsetWidth||0,S=()=>x-H()*k,Z=()=>S()+H(),H=()=>F()/T,U=()=>h.zoomSpeed*T,$=e=>(e-S())/H(),O=e=>(e-x)/F(),ee=(e,a)=>{let m=T-a;return e===1&&m<=h.minZoom||e===-1&&m>=h.maxZoom?!1:(T=m,!0)},j=e=>{let a=k+e;a>=0&&(a=0),a+T<=1&&(a=1-T),k=a},P=(e,a)=>{let m=e*U(),n=a*m;ee(e,m)&&j(n),A()},te=e=>{j(e),A()},ne=e=>{if(!e)return;let a=0,m=e.start-e.duration*.05,t=e.end+e.duration*.05-m,d=F()/t,o=Math.sign(T-d);if(o>0){let b=(S()+H()/2-m)/t,s=S()+H()*b;a=O(s)}else{let u=m+t/2,b=$(u),s=m+t*b;a=O(s)}e!=R()&&V.push(e);let i=()=>{clearInterval(p),y=e.parent||y,A()},c=()=>{A()},p=setInterval(()=>{P(o,a),o<0&&T>d&&i(),o>0&&T<d&&i()},1)},re=e=>{window.addEventListener("resize",()=>{A()},{passive:!0}),e.addEventListener("wheel",r=>{var i=Math.sign(r.deltaY);let b=(((r.target.attributes.starttime?$(r.target.attributes.starttime):0)*e.getBoundingClientRect().width+r.offsetX)/Q()-k)/T;P(i,b)},{passive:!0});let a,m,n=!1,t=!0;e.addEventListener("mousedown",r=>{n=!0,a=r.pageX,m=r.pageY},{passive:!0}),e.addEventListener("mousemove",r=>{if(!n||!t)return;t=!1;let i=(r.pageX-a)*h.dragSpeed;i&&te(i),a=r.pageX,m=r.pageY,setTimeout(()=>t=!0,10)},{passive:!0}),e.addEventListener("mouseup",()=>{n=!1},{passive:!0});let d=(r,i)=>{let c=document.createDocumentFragment();if(r.description){let u=document.createElement("H1");u.innerHTML=r.title,c.appendChild(u);let b=document.createElement("p");b.innerHTML=r.description,c.appendChild(b),i(c);return}if(r.wikipedia){fetch(r.wikipedia).then(u=>u.json()).then(u=>{let b=document.createElement("H1");b.innerHTML=r.title,c.appendChild(b);let s=document.createElement("p");s.innerHTML=r.description,c.appendChild(s),i(c)});return}let p=document.createElement("H3");p.innerHTML="No detail information found...",c.appendChild(p),i(c)},o=r=>{let i=document.createDocumentFragment(),c=document.createElement("div");c.style.overflow="auto",[...V].reverse().forEach(p=>{let u=document.createElement("a");u.innerHTML=p.title,u.href="#",u.style.cursor="pointer",u.addEventListener("click",b=>{b.preventDefault(),u.dispatchEvent(new CustomEvent("event-click",{detail:p,bubbles:!0,cancelable:!0}))}),c.appendChild(u),c.appendChild(document.createElement("br"))}),i.appendChild(c),r(i)};e.addEventListener("detail-click",r=>{let i=document.createElement("div");i.className="timelineDetailsContainer",i.style.zIndex="5",i.style.position="absolute",i.style.right="0",i.style.top="0",i.style.height="100%",i.style.width="50%",i.style.padding="10px",i.style.backgroundColor="white";let c=document.createElement("div");c.className="timelineDetailsCloseContainer",c.style.position="absolute",c.style.right="10px",c.style.top="10px",c.style.padding="3px",c.style.cursor="pointer",c.style.borderRadius="5px",c.innerHTML=">",c.addEventListener("click",u=>{c.dispatchEvent(new CustomEvent("detail-close-click",{bubbles:!0})),e.removeChild(i)}),i.append(c);let p=document.createElement("div");p.className="timelineDetailsBodyContainer",p.innerHTML="<h3>Loading...</h3>",i.append(p),e.append(i),d(r.detail,u=>{p.innerHTML="",p.appendChild(u)})}),e.addEventListener("navigate-click",()=>{let r=document.createElement("div");r.className="timelineNavigateContainer",r.style.zIndex="5",r.style.position="absolute",r.style.left="0",r.style.top="0",r.style.height="100%",r.style.width="30%",r.style.padding="10px",r.style.backgroundColor="white",e.append(r);let i=document.createElement("div");i.className="timelineNavigateCloseContainer",i.style.position="absolute",i.style.right="10px",i.style.top="10px",i.style.padding="3px",i.style.cursor="pointer",i.style.border="solid 1px black",i.style.borderRadius="5px",i.innerHTML="<",i.addEventListener("click",u=>{i.dispatchEvent(new CustomEvent("navigate-close-click",{bubbles:!0})),e.removeChild(r)}),r.append(i);let c=document.createElement("div");c.className="timelineNavigateBodyHeadlineContainer",c.innerHTML="History",r.append(c);let p=document.createElement("div");p.className="timelineNavigateBodyContainer",p.addEventListener("event-click",u=>{e.removeChild(r)}),r.append(p),o(u=>{p.appendChild(u)})})},ie=e=>{let a=document.createDocumentFragment(),m=t=>{if(t.start>=Z()||t.end<=S())return;let d=$(t.start),o=document.createElement("div"),r=t.duration/H()*100;return o.style.left=d*100+"%",o.style.width=r+"%",o.style.position="absolute",o.style.minWidth="5px",o.title=t.title,o.className="timelineEventGenerated",o.attributes.starttime=t.start,o.attributes.expanded=r>h.expandRatio,o},n=t=>{let d=document.createElement("div");return d.title=t.title,d.innerText=t.title,d.className="timelineEventGeneratedTitle",d.style.whiteSpace="nowrap",d.style.pointerEvents="none",d.style.userSelect="none",d};if(!e.children.length)try{let t=m(e);if(t){let d=e.height+(e.height-1)*.5,o=e.level*1.5,r=e.color.map(i=>i-Math.pow(10,e.depth));t.style.bottom=`${o*h.eventHeight}px`,t.style.minHeight=`${d*h.eventHeight}px`,t.style.borderRadius="5px",t.style.boxSizing="border-box",t.style.border="1px solid rgba(100,100,100,.5)",t.style.backgroundColor=`rgb(${r[0]},${r[1]},${r[2]})`,t.style.zIndex=e.depth.toString(),R().depth==e.depth&&e!=R()&&(t.style.opacity=".2"),a.appendChild(t)}}catch(t){console.error(t,"timelineEvent",e)}return e.children.filter(t=>t.type==="background").forEach((t,d)=>{try{let o=m(t);if(o){let r=t.color.map(i=>i-Math.pow(10,t.depth));o.style.bottom="0px",o.style.minHeight="100%",o.style.backgroundColor=`rgba(${r[0]},${r[1]},${r[2]}, .05)`,o.addEventListener("click",i=>{o.dispatchEvent(new CustomEvent("background-event-click",{detail:t,bubbles:!0}))}),o.append(n(t)),a.appendChild(o)}}catch(o){console.error(o,"backgroundEvent",t)}}),e.children.filter(t=>t.type==="timeline").forEach((t,d)=>{try{let o=m(t);if(o){let r=t.height+(t.height-1)*.5,i=(t.level+e.level-1)*1.5,c=t.color.map(p=>p-Math.pow(10,t.depth));o.style.bottom=`${i*h.eventHeight}px`,o.style.minHeight=`${r*h.eventHeight}px`,o.style.borderRadius="5px",o.style.boxSizing="border-box",o.style.cursor="pointer",o.style.border="1px solid rgba(100,100,100,.5)",o.style.backgroundColor=`rgb(${c[0]},${c[1]},${c[2]})`,o.style.zIndex=t.depth.toString(),o.addEventListener("click",p=>{o.dispatchEvent(new CustomEvent("event-click",{detail:t,bubbles:!0,cancelable:!0}))}),t.start<S()&&t.end>Z()&&t.children.length&&(y=t),R().depth==t.depth&&t!=R()&&(o.style.opacity=".2"),a.appendChild(o)}}catch(o){console.error(o,"timelineEvent",t)}}),a},oe=()=>{g.style.position="relative",g.style.overflow="hidden",g.style.minHeight="3rem";let e=g.querySelector(".timelineHeaderContainer");N=e||document.createElement("div"),e||g.appendChild(N),N.className="timelineHeaderContainer",N.style.width="100%",N.style.height="20px",N.style.backgroundColor="white";let a=g.querySelector(".timelineLabelContainer");switch(C=a||document.createElement("div"),a||g.appendChild(C),C.className="timelineLabelContainer",C.style.width="100%",C.style.height="50px",C.style.textAlign="center",C.style.position="absolute",C.style.pointerEvents="none",C.style.userSelect="none",h.position){case"top":C.style.top="20px";break;default:C.style.bottom="0"}let m=g.querySelector(".timelineDividerContainer");M=m||document.createElement("div"),m||g.appendChild(M),M.className="timelineDividerContainer",M.style.width="100%",M.style.height="calc(100% - 20px)",M.style.position="absolute",M.style.zIndex="-2",M.style.bottom="0";let n=g.querySelector(".timelineEventsContainer");E=n||document.createElement("div"),n||g.appendChild(E),E.className="timelineEventsContainer",E.style.position="absolute",E.style.bottom="50px",E.style.height="calc(100% - 70px)",E.style.width="100%"},se=e=>{let a=new Date(e*6e4);return H()<5760?Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}).format(a):H()<60480?Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"numeric"}).format(a):H()<788923.1502?Intl.DateTimeFormat(void 0,{year:"numeric",month:"short"}).format(a):a.getFullYear().toString()},A=()=>{if(!g)return;let e=Math.floor(T),a=Math.pow(2,Math.floor(Math.log2(e))),m=1/(h.labelCount+1),n=S()-x,d=F()*m/a,r=Math.floor(n/d)*d,i=document.createDocumentFragment(),c=document.createDocumentFragment();for(let l=0;l<h.labelCount+2;l++){let f=(l+1)*d+x+r-d,X=f+d/2,ce=$(f)*100,de=$(X)*100,D=document.createElement("div");D.className="timelineLabel",D.style.left=ce+"%",D.style.top="50%",D.style.transform="translate(calc(-50%), calc(-50%))",D.style.textAlign="center",D.style.position="absolute",D.style.zIndex="-1",D.style.width=m*100+"%",D.innerHTML=se(f),i.appendChild(D);let I=document.createElement("div");I.className="timelineDivider",I.style.left=de+"%",I.style.textAlign="center",I.style.position="absolute",I.style.height="100%",I.style.zIndex="-10",I.innerHTML="",c.appendChild(I)}C.innerHTML="",C.appendChild(i),M.innerHTML="",M.appendChild(c),y.start>S()&&y.end<Z()&&y.parent&&(y=y.parent);let p=ie(y);E.innerHTML="",E.appendChild(p);let u=document.createDocumentFragment(),b=document.createElement("div");b.className="timelineHeader",b.style.textAlign="center",b.innerHTML=R().title,u.appendChild(b);let s=document.createElement("div");if(s.className="timelineNavigate",s.style.position="absolute",s.style.top="0px",s.style.left="5px",s.style.cursor="pointer",s.innerHTML="< Navigate",s.addEventListener("click",l=>{s.dispatchEvent(new CustomEvent("navigate-click",{bubbles:!0}))}),u.appendChild(s),y){let l=document.createElement("div");l.className="timelineBack",l.style.position="absolute",l.style.top="0px",l.style.right="5px",l.style.cursor="pointer",l.innerHTML="Read more >",l.title="Read more on "+y.title,l.addEventListener("click",f=>{l.dispatchEvent(new CustomEvent("detail-click",{detail:y,bubbles:!0}))}),u.appendChild(l)}N.innerHTML="",N.appendChild(u),g.dispatchEvent(new CustomEvent("update",{detail:le(),bubbles:!0,cancelable:!0,composed:!1}))},z=e=>{if(e===void 0)return;let a=n=>{let t=new Date;if(t.setDate(n[2]?n[2]:1),t.setMonth(n[1]?n[1]-1:0),t.setHours(n[3]?n[3]:0),t.setMinutes(n[4]?n[4]:0),t.setSeconds(0),!n[0])return t.getTime()/6e4;if(n[0]&&n[0]>-27e4&&n[0]<27e4)return t.setFullYear(n[0]),t.getTime()/6e4;let d=525948.766*n[0];return t.setFullYear(0),d+t.getTime()/6e4},m=n=>{switch(n){case"now":return new Date;default:let t=Number(n.replace(/y$/,""));return isNaN(t)?new Date(n):new Date(Date.now()+31556926*1e3*t)}};if(Array.isArray(e)){let n=e;if(n.length===0)throw new Error("argument Array cannot be empty");if(!n.every(d=>typeof d=="number"))throw new Error("input Array must contain only numbers");return a(n)}if(typeof e=="object"&&e.constructor.name==="Date")return e.getTime()/6e4;if(typeof e=="string")return m(e).getTime()/6e4;if(typeof e=="number")return new Date(e).getTime()/6e4},G=(e,a)=>{if(!e){console.warn("Event object is empty");return}let m=s=>s.every(l=>typeof l=="number"),n=q(Y({type:"timeline",duration:0,color:[240,240,240],expanded:!1,level:0,step:0,score:0,height:0,children:[],parent:a,depth:a?a.depth+1:0},e),{start:z(e.start),end:z(e.end)}),t=e.events?e.events.reduce((s,l)=>{let f=G(l,n);return f&&s.push(f),s},[]):[];n.children=t.sort((s,l)=>s.start-l.start);let d=n.start?n.children.length?Math.min(n.start,n.children[0].start):n.start:n.children.length?n.children[0].start:void 0;if(!d){console.warn("Missing start property on event - skipping",e);return}let o=n.end?n.end:n.duration&&!isNaN(Number(n.duration))?d+Number(n.duration):n.children.length&&n.children[n.children.length-1].end||d+1,r=e.color?m(e.color)?e.color:[240,240,240]:[240,240,240],i={1:{height:0,time:Number.MIN_SAFE_INTEGER}},c=s=>{let l=0;for(let f in i)if(l=Number(f),s.start>i[f].time){for(let X=0;X<s.height;X++)i[(l+X).toString()]={height:s.height,time:s.end};return l}l++;for(let f=0;f<s.height;f++)i[(l+f).toString()]={height:s.height,time:s.end};return l},p={1:{height:0,time:Number.MIN_SAFE_INTEGER}},u=s=>{let l=0;for(let f in p)if(l=Number(f),s.start>p[f].time)return p[l.toString()]={height:s.height,time:s.end},l;return l++,p[l.toString()]={height:s.height,time:s.end},l},b=s=>{let l=1;return l=(s.duration||1)/F()*n.children.length,l};return n.children.forEach((s,l)=>{s.score=b(s),s.level=s.type==="timeline"?c(s):0,s.step=s.type==="timeline"?u(s):0}),n.type=e.type||"timeline",n.duration=o-d,n.color=r,n.start=d,n.end=o,n.height=t.length?Math.max.apply(1,t.map(s=>s.level)):1,n},ae=e=>{let a=[],m=e.querySelectorAll(".timelineEvent");return m&&m.forEach(n=>{try{a.push(q(Y({},n.attributes),{events:ae(n)}))}catch(t){console.error(t,"timelineEvent")}}),a},le=()=>({options:h,viewStartDate:S(),viewEndDate:Z(),viewDuration:H(),ratio:T,pivot:k});return K(L,v,w),{focus:ne}};window.Timeline=J;})();
